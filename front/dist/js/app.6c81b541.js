(function(){var e={8105:function(e,t,a){"use strict";var s=a(7195),r=a(4359),i=a(7244);a(7024);s["default"].use(r.XG7),s["default"].use(i.X);a(186);var l=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("b-container",{attrs:{fluid:"lg"}},[t("b-row",[t("b-col",[null==e.user?t("AuthorizationPage",{attrs:{connection:e.connection,messageService:e.messageService},on:{authorized:e.logIn}}):t("HomePage",{attrs:{user:e.user,crud:e.crudService,messageService:e.messageService},on:{closed:e.logOut}})],1)],1)],1)],1)},n=[],o=function(){var e=this,t=e._self._c;return t("b-container",{attrs:{fluid:"sm"}},[t("b-row",{attrs:{"align-h":"center","align-v":"center"}},[t("b-col",{attrs:{col:"",md:"7",lg:"5",center:""}},[t("b-card",{attrs:{deck:""}},[t("b-form-group",{staticClass:"mb-0",attrs:{label:"Авторизация","label-size":"lg","label-class":"font-weight-bold pt-0"}},[t("b-form-group",{attrs:{label:"Логин","label-for":"login","label-align":"left","invalid-feedback":"Неверный логин",state:e.usernameState}},[t("b-form-input",{attrs:{id:"login",trim:"",disabled:e.isDisabled,state:e.usernameState},model:{value:e.login,callback:function(t){e.login=t},expression:"login"}})],1),t("b-form-group",{attrs:{label:"Пароль","label-for":"password","label-align":"left","invalid-feedback":"Неверный пароль",state:e.passwordState}},[t("b-form-input",{attrs:{id:"password",disabled:e.isDisabled,state:e.passwordState,type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),t("b-button",{attrs:{disabled:e.isDisabled,type:"submit",variant:"primary"},on:{click:e.tryLogIn}},[e._v("Войти")])],1),this.timer>0?t("div",[t("p",[e._v("Вы исчерпали количество попыток на авторизацию")]),t("a",[e._v("Времени до следующей попытки осталось "+e._s(e.timer/60>>0)+":"+e._s(e.timer%60<10?"0"+String(e.timer%60):e.timer%60))])]):e._e()],1)],1)],1)],1)},d=[],u=a(6318);class p{constructor(e){(0,u.Z)(this,"_toast",null),this._toast=e}show(e,t){this._toast.toast(t,{title:e,autoHideDelay:5e3,appendToast:!0})}showError(e){this._toast.toast(e,{title:"Произошла ошибка",autoHideDelay:5e3,appendToast:!0,variant:"danger"})}showDelete(e){this.show("Удаление","Запсиь о "+e+" удалена")}showCreate(e){this.show("Создание","Запсиь о "+e+" создана")}showUpdate(e){this.show("Обновление","Запсиь о "+e+" обновлена")}}var m=a(306),c={name:"AuthorizationPage",data(){document.title="SAD Auth";var e=this.$cookie.get("timer");return e>0&&this.startTimer(),{login:"",password:"",isDisabled:e>0,passwordState:null,usernameState:null,maxTryCount:3,timeOut:180,countTry:0,timer:e,user:{accessToken:""},endPoint:"/sad/api/login"}},props:{connection:{type:String,required:!0},messageService:{type:p,required:!0}},methods:{tryLogIn(){if(this.countTry<this.maxTryCount){this.countTry++,this.isDisabled=!0,this.messageService.show("Авторизация","Попытка авторизации"),m.Z.defaults.withCredentials=!0;let e={withCredentials:!0,header:{"Content-Type":"application/x-www-form-urlencoded"}},t=new FormData;t.append("username",this.login),t.append("password",this.password),m.Z.post(this.endPoint,t,e).then((e=>{this.messageService.show("Авторизация",this.login+" успешно авторизован");let t={username:this.login,isAdmin:e.data.isAdmin};console.log("userdata",t),this.login="",this.password="",this.isDisabled=!1,console.log(e),this.countTry=0,this.$emit("authorized",t)})).catch((e=>{this.usernameState=!1,this.passwordState=!1,this.messageService.showError(e.message),this.isDisabled=!1}))}else this.isDisabled=!0,this.timer=this.timeOut,this.startTimer()},startTimer(){var e=setInterval((()=>{this.timer>0?(this.timer--,this.$cookie.set("timer",this.timer,"{0}s".f(this.timer))):(this.countTry=0,this.isDisabled=!1,clearTimeout(e))}),1e3)}}},h=c,f=a(1001),b=(0,f.Z)(h,o,d,!1,null,null,null),v=b.exports,y=function(){var e=this,t=e._self._c;return t("b-card",{attrs:{"no-body":""}},[t("b-tabs",{attrs:{card:"",fill:""},scopedSlots:e._u([{key:"tabs-end",fn:function(){return[t("li",{staticClass:"nav-item align-self-center",attrs:{role:"presentation"}},[t("div",[t("span",[e._v(" "+e._s(e.user.username)+" ")]),t("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:e.close}},[e._v("Выход")])],1)])]},proxy:!0}])},[t("b-tab",{attrs:{title:"Поставки",lazy:""}},[t("SuppliesView",{attrs:{user:e.user,crud:e.crud,messageService:e.messageService}})],1),t("b-tab",{attrs:{title:"Цены",lazy:""}},[t("SuppliedDetailsView",{attrs:{user:e.user,crud:e.crud,messageService:e.messageService}})],1),t("b-tab",{attrs:{title:"Детали",lazy:""}},[t("DetailsView",{attrs:{user:e.user,crud:e.crud,messageService:e.messageService}})],1),t("b-tab",{attrs:{title:"Поставщики",lazy:""}},[t("SuppliersView",{attrs:{user:e.user,crud:e.crud,messageService:e.messageService}})],1),"true"==e.user.isAdmin?t("b-tab",{attrs:{title:"Пользователи",lazy:""}},[t("UsersView",{attrs:{user:e.user,crud:e.crud,messageService:e.messageService}})],1):e._e()],1)],1)},g=[],S=function(){var e=this,t=e._self._c;return t("div",[t("TableComponent",{ref:"table",attrs:{fields:e.fields,dataProvider:e.dataProvider},on:{itemAdd:e.addTableItemHandler,itemRemove:e.removeTableItemHandler,itemEdit:e.editTableItemHandler}}),t("div",[t("RemoveModalComponent",{ref:"RemoveItemModal",attrs:{contentPresenter:t=>e.supplyPresenter(t),okHandler:e.removeItem}}),t("SupplyModalComponent",{ref:"CreateItemModal",attrs:{title:"Создание записи o поставке",submitHandler:e.addItem,crud:e.crud}}),t("SupplyModalComponent",{ref:"EditItemModal",attrs:{title:"Редактирование записи o поставке",submitHandler:e.updateItem,crud:e.crud}})],1)],1)},D=[],I=function(){var e=this,t=e._self._c;return t("b-container",{attrs:{fluid:""}},[t("b-row",[t("b-col",{attrs:{cols:"auto"}},[t("b-form-group",{attrs:{label:"Отображать по","label-for":"per-page-select","label-cols":"auto","label-align-sm":"left","label-size":"sm"}},[t("b-form-select",{attrs:{id:"per-page-select",options:e.pPageOptions,size:"sm"},model:{value:e.pContext.perPage,callback:function(t){e.$set(e.pContext,"perPage",t)},expression:"pContext.perPage"}})],1)],1),t("b-col"),t("b-col",[t("div",{attrs:{align:"end"}},[t("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:e.addItem}},[e._v("Добавить")])],1)])],1),t("b-table",{attrs:{striped:"",hover:"",bordered:"","show-empty":"",filter:e.pFilter,items:e.getItems,fields:e.fields,"current-page":e.pContext.currentPage,"per-page":e.pContext.perPage,"sort-by":e.pContext.sort.by,"sort-desc":e.pContext.sort.desc},on:{"update:sortBy":function(t){return e.$set(e.pContext.sort,"by",t)},"update:sort-by":function(t){return e.$set(e.pContext.sort,"by",t)},"update:sortDesc":function(t){return e.$set(e.pContext.sort,"desc",t)},"update:sort-desc":function(t){return e.$set(e.pContext.sort,"desc",t)}},scopedSlots:e._u([{key:"cell(actions)",fn:function(a){return[t("div",[1==a.field.editable||void 0==a.field.editable?t("b-button",{staticClass:"actionButton",attrs:{variant:"primary",size:"sm"},on:{click:function(t){return e.editItem(a.item)}}},[t("b-icon",{attrs:{icon:"pencil-square"}})],1):e._e(),1==a.field.removable||void 0==a.field.removable?t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){return e.removeItem(a.item)}}},[t("b-icon",{attrs:{icon:"trash-fill"}})],1):e._e()],1)]}},{key:"head()",fn:function(a){return[t("div",[t("div",[t("span",[e._v(e._s(a.label))])]),a.field.filtrable?t("div",[t("b-input-group",{attrs:{size:"sm"}},[t("b-form-input",{attrs:{id:"filter-input",type:"search",placeholder:"Введите для поиска",debounce:"500"},on:{update:e.update},model:{value:e.pContext.filters[a.field.key],callback:function(t){e.$set(e.pContext.filters,a.field.key,t)},expression:"pContext.filters[scope.field.key]"}})],1)],1):t("div",{staticClass:"block"})])]}},{key:"empty",fn:function(){return[null==e.pContext.error?t("p",[e._v("Записи отсутствуют")]):t("p",[e._v("Произошла ошибка: "+e._s(e.pContext.error))])]},proxy:!0},{key:"table-busy",fn:function(){return[t("p",[e._v("Гружусь...")])]},proxy:!0},{key:"emptyfiltered",fn:function(){return[t("p",[e._v("По вашему запросу ничего не нашлось :(")])]},proxy:!0}])}),t("b-row",[t("b-col",[t("div",{attrs:{align:"start"}},[0==e.pContext.size?t("p",[e._v(" Записей нет ")]):t("p",[e._v(" Отображено с "+e._s((e.pContext.currentPage-1)*e.pContext.perPage+1)+" по "+e._s((e.pContext.currentPage-1)*e.pContext.perPage+e.pContext.size)+" записей из "+e._s(e.pContext.totalRows)+" ")])])]),t("b-col",{attrs:{cols:"4"}},[t("b-pagination",{staticClass:"my-0",attrs:{"total-rows":e.pContext.totalRows,"per-page":e.pContext.perPage,align:"fill",size:"sm"},model:{value:e.pContext.currentPage,callback:function(t){e.$set(e.pContext,"currentPage",t)},expression:"pContext.currentPage"}})],1)],1)],1)},w=[],P={name:"TableComponent",data(){let e={totalRows:1,totalPages:1,perPage:5,currentPage:1,size:0,sort:{by:this.fields[0].key,desc:!1},filters:{},error:null};return console.log("поля",this.fields),this.fields.forEach((t=>{t.filtrable&&(e.filters[t.key]="")})),{pIsBusy:!1,pContext:e,pPageOptions:[5,10,20,50,100],pFilter:null}},props:{fields:Array,dataProvider:Function},computed:{isBusy:{get:function(){return this.pIsBusy},set:function(e){this.pIsBusy=e}},totalRows:function(){return this.pContext.totalRows},totalPages:function(){return this.pContext.totalPages},currentPage:function(){return this.pContext.currentPage},perPage:function(){return this.pContext.perPage}},methods:{addItem(){this.$emit("itemAdd")},removeItem(e){this.$emit("itemRemove",e)},editItem(e){this.$emit("itemEdit",e)},update(){this.pIsBusy=!0,this.pFilter="a"==this.pFilter?"b":"a",this.pIsBusy=!1},getItems(){this.pIsBusy=!0,this.pContext.error=null;let e=this.dataProvider(this.pContext);return console.log("lolkek",e),this.pIsBusy=!1,e}}},C=P,M=(0,f.Z)(C,I,w,!1,null,null,null),k=M.exports,x=function(){var e=this,t=e._self._c;return t("div",[t("CustomModalComponent",{ref:"custom-modal",attrs:{title:"Подтверждение удаления записи",okHandler:e.okHandler},scopedSlots:e._u([{key:"body",fn:function(){return[t("p",[e._v("Вы действительно хотите удалить запись о "+e._s(e.content)+"?")])]},proxy:!0}])})],1)},_=[],H=function(){var e=this,t=e._self._c;return t("div",[t("b-modal",{ref:"modal",attrs:{title:e.title,"ok-title":"Ок","cancel-title":"Отмена",lazy:!0},on:{hidden:e.cancelHandler,ok:function(t){return e.okHandler(e.modalData,t)},cancel:e.cancelHandler}},[e._t("body",null,{data:e.modalData})],2)],1)},T=[],E={name:"CustomModalComponent",data(){return{modalData:this.defaultData}},props:{title:{type:String,default:"Сообщение"},okHandler:{type:Function,default:function(){}},cancelHandler:{type:Function,default:function(){}},defaultData:{default:()=>({})}},methods:{show(e){this.modalData=e,this.$refs["modal"].show()},close(){this.$refs["modal"].hide()}},computed:{data:function(){return this.modalData}}},$=E,R=(0,f.Z)($,H,T,!1,null,null,null),q=R.exports,A={name:"RemoveModalComponent",components:{CustomModalComponent:q},data(){return{result:!1,content:""}},props:{contentPresenter:Function,okHandler:Function},methods:{show(e){this.content=this.contentPresenter(e),this.$refs["custom-modal"].show(e)},close(){this.$refs["custom-modal"].close()}}},N=A,U=(0,f.Z)(N,x,_,!1,null,null,null),O=U.exports,Z=function(){var e=this,t=e._self._c;return t("div",[t("CustomModalComponent",{ref:"custom-modal",attrs:{okHandler:e.submit,title:e.title},scopedSlots:e._u([{key:"body",fn:function(){return[t("form",{ref:"form"},[t("b-form-group",{attrs:{label:"Дата","label-for":"date-input","invalid-feedback":"Неверный формат даты"}},[t("b-form-input",{attrs:{id:"date-input",debounce:"500",type:"date",required:""},model:{value:e.data.date,callback:function(t){e.$set(e.data,"date",t)},expression:"data.date"}})],1),t("b-form-group",{attrs:{label:"Поставщик","label-for":"supplier-input"}},[t("b-form-select",{attrs:{id:"supplier-input",options:e.suppliers,"text-field":"text","value-field":"entityId",required:""},model:{value:e.supplierId,callback:function(t){e.supplierId=t},expression:"supplierId"}})],1),t("b-form-group",{attrs:{label:"Поставляемая деталь","label-for":"suppliedDetail-input","invalid-feedback":"Нужно выбрать деталь"}},[t("b-form-select",{attrs:{id:"suppliedDetail-input",options:e.suppliedDetails,"text-field":"text","value-field":"entityId",state:e.suppliedDetailState,required:""},model:{value:e.suppliedDetailId,callback:function(t){e.suppliedDetailId=t},expression:"suppliedDetailId"}})],1),t("b-form-group",{attrs:{label:"Цена за деталь","label-for":"costPerDetail-input","invalid-feedback":"Неверный формат даты"}},[t("b-form-input",{attrs:{id:"costPerDetail-input",debounce:"500",type:"number",readonly:""},model:{value:e.costPerDetail,callback:function(t){e.costPerDetail=t},expression:"costPerDetail"}})],1),t("b-form-group",{attrs:{label:"Количество","label-for":"name-input","invalid-feedback":"Количество должно быть больше 0"}},[t("b-form-input",{attrs:{id:"name-input",placeholder:"Введите количество",debounce:"500",state:e.amountState,type:"number",required:""},model:{value:e.data.amount,callback:function(t){e.$set(e.data,"amount",t)},expression:"data.amount"}})],1),t("b-form-group",{attrs:{label:"Итоговая стоимость","label-for":"costPerDetail-input","invalid-feedback":"Неверный формат даты"}},[t("b-form-input",{attrs:{id:"costPerDetail-input",debounce:"500",type:"number",readonly:""},model:{value:e.costAll,callback:function(t){e.costAll=t},expression:"costAll"}})],1)],1)]},proxy:!0}])})],1)},z=[];a(7658);class V{_getRequest(e,t,a){var s=[];if(void 0!=a&&(void 0!=a.sort&&(s.push({name:"sortBy",value:"partNumber"==a.sort.by?"PART_NUMBER":a.sort.by.toUpperCase()}),s.push({name:"sortOrder",value:a.sort.desc?"DESC":"ASC"})),void 0!=a.currentPage&&s.push({name:"page",value:a.currentPage}),void 0!=a.perPage&&s.push({name:"pageSize",value:a.perPage}),void 0!=a.filters))for(var r in a.filters)a.filters[r].length>0&&s.push({name:r,value:a.filters[r]});return console.log("get request",this.createRequest(e,s)),m.Z.get(this.createRequest(e,s),{headers:t}).then((e=>(console.log(e),void 0!=a&&(a.totalRows=e.data.total,a.size=e.data.items.length),console.log("response",e),void 0==e.data.items?e.data:e.data.items)))}_putRequest(e,t,a,s){return m.Z.put(this.createRequest(e,s),a)}_postRequest(e,t,a,s){return console.log("post",a),m.Z.post(this.createRequest(e,s),a,{headers:t})}_deleteRequest(e,t,a){return m.Z["delete"](this.createRequest(e+"/"+a.entityId),{headers:t})}constructor(){}get accessHeader(){return{}}get suppliesEndPoint(){return"/sad/api/supplies"}get detailsEndPoint(){return"/sad/api/parts"}get suppliersEndPoint(){return"/sad/api/suppliers"}get suppliedDetailsEndPoint(){return"/sad/api/parts/supplied"}get parallelsEndPoint(){return"/sad/api/parallels"}get usersEndPoint(){return"/sad/api/users"}createRequest(e,t){var a=e;if(void 0!=t&&t.length>0){a+="?";var s="";for(let e=0;e<t.length;e++)s=s+"&"+t[e].name+"="+t[e].value;a+=s.substring(1)}return a}getSupply(e){return this._getRequest(this.suppliesEndPoint+"/"+e).then((e=>(e.date=e.date.split("T")[0],e)))}getSupplier(e){return this._getRequest(this.suppliersEndPoint+"/"+e)}getDetail(e){return this._getRequest(this.detailsEndPoint+"/"+e)}getSuppliedDetail(e){return this._getRequest(this.suppliedDetailsEndPoint+"/"+e).then((e=>(e.date=e.date.split("T")[0],e)))}getEmptySupplier(){return{name:"[Данные удалены]",address:"[Данные удалены]",phone:"[Данные удалены]"}}getEmptyDetail(){return{name:"[Данные удалены]",partNumber:"[Данные удалены]",note:"[Данные удалены]"}}getEmptySuppliedDetail(){return{amount:0,supplierData:this.getEmptySupplier(),detailData:this.getEmptyDetail()}}getSupplies(e){return this._getRequest(this.suppliesEndPoint,this.accessHeader,e).then((async e=>await this.getSuppliedDetails({perPage:100}).then((t=>(e.forEach((e=>{let a=t.find((t=>t.entityId==e.suppliedParts));e.suppliedDetailData=null!=a?a:this.getEmptySuppliedDetail(),e.date=e.date.split("T")[0]})),e)))))}getDetails(e){return this._getRequest(this.detailsEndPoint,this.accessHeader,e)}getSuppliedDetails(e){return this._getRequest(this.suppliedDetailsEndPoint,this.accessHeader,e).then((async e=>{let t=this.getSuppliers({perPage:100}).then((t=>{e.forEach((e=>{let a=t.find((t=>t.entityId==e.supplier));e.supplierData=null!=a?a:this.getEmptySupplier(),e.date=e.date.split("T")[0]}))})),a=this.getDetails({perPage:100}).then((t=>{e.forEach((e=>{let a=t.find((t=>t.entityId==e.part));e.detailData=null!=a?a:this.getEmptyDetail()}))}));return await Promise.all([t,a]),e}))}getSuppliers(e){return this._getRequest(this.suppliersEndPoint,this.accessHeader,e)}getParallels(e){return this._getRequest(this.parallelsEndPoint,this.accessHeader,e)}getUsers(e){return this._getRequest(this.usersEndPoint+"/list",this.accessHeader,e)}updateSupply(e,t){return this._putRequest(this.suppliesEndPoint,this.accessHeader,{id:t.id,entityId:t.entityId,suppliedParts:t.suppliedParts,amount:t.amount,date:t.date+"T08:19:07.715"})}updateDetail(e,t){return console.log("updateDetail",t),this._putRequest(this.detailsEndPoint,this.accessHeader,t)}updateSuppliedDetail(e,t){return this._putRequest(this.suppliedDetailsEndPoint,this.accessHeader,{id:t.id,entityId:t.entityId,cost:t.cost,part:t.part,supplier:t.supplier,date:t.date+"T08:19:07.715"})}updateSupplier(e,t){return console.log("updateSupplier",t),this._putRequest(this.suppliersEndPoint,this.accessHeader,t)}updateUser(e,t){return this._putRequest(this.usersEndPoint,this.accessHeader,t)}addSupply(e){return this._postRequest(this.suppliesEndPoint,this.accessHeader,{amount:Number(e.amount),suppliedParts:e.suppliedParts,date:e.date+"T08:19:07.715"})}addDetail(e){return this._postRequest(this.detailsEndPoint,this.accessHeader,e)}addSuppliedDetail(e){return this._postRequest(this.suppliedDetailsEndPoint,this.accessHeader,{cost:Number(e.cost),part:e.part,supplier:e.supplier,date:e.date+"T08:19:07.715"})}addSupplier(e){return this._postRequest(this.suppliersEndPoint,this.accessHeader,e)}addUser(e){return this._postRequest(this.usersEndPoint,this.accessHeader,e,[])}removeSupply(e){return this._deleteRequest(this.suppliesEndPoint,this.accessHeader,{entityId:e})}removeDetail(e){return this._deleteRequest(this.detailsEndPoint,this.accessHeader,{entityId:e})}removeSuppliedDetail(e){return this._deleteRequest(this.suppliedDetailsEndPoint,this.accessHeader,{entityId:e})}removeSupplier(e){return this._deleteRequest(this.suppliersEndPoint,this.accessHeader,{entityId:e})}removeUser(e){return this._deleteRequest(this.usersEndPoint,this.accessHeader,{entityId:e})}deletedSuffix(e){return null==e||void 0==e?"[удален]":""}supplyPresenter(e){if(null==e||void 0==e)return"Отсутствует";var t=null;return this.getSupply(e.suppliedDetail).then((e=>t=e)),t+e.name+this.deletedSuffix(e)}classPresenter(e){return null==e||void 0==e?"Отсутствует":e.parallel.parallelNumber+" '"+e.letter+"' "+e.studyYear.name+this.deletedSuffix(e)}studentPresenter(e){return null==e||void 0==e?"Отсутствует":this.teacherPresenter(e)+" "+this.classPresenter(e.course)+")"+this.deletedSuffix(e)}teacherPresenter(e){return null==e||void 0==e?"Отсутствует":e.secondName+" "+e.firstName+" "+e.patronymic+this.deletedSuffix(e)}parallelPresenter(e){return null==e||void 0==e?"Отсутствует":e.parallelNumber+this.deletedSuffix(e)}userPresenter(e){return e.username+this.deletedSuffix(e)}isAdmin(e){return e.roles.includes(this._adminRole)}isModerator(e){return e.roles.includes(this._moderatorRole)}}var F={name:"SupplyModalComponent",components:{CustomModalComponent:q},data(){return{suppliedDetailId:null,supplierId:null,suppliers:[],loadedSuppliedDetails:[],data:{id:null,date:(new Date).format("yyyy-mm-dd"),amount:0}}},props:{title:{type:String,default:"Редактирование записи"},submitHandler:{type:Function,default:function(){}},crud:{type:V,required:!0}},methods:{async show(e){this.$refs["custom-modal"].show(this.data),await this.updateData(),void 0!==e?(this.data.id=e.id,this.data.entityId=e.entityId,this.data.name=e.name,this.data.date=e.date,this.data.amount=e.amount,this.supplierId=e.suppliedDetailData.supplier,this.suppliedDetailId=e.suppliedParts):(this.data.id="",this.data.date=(new Date).format("yyyy-mm-dd"),this.data.amount=0)},close(){this.$refs["custom-modal"].close()},async updateData(){await this.crud.getSuppliedDetails({sort:{by:"cost",desc:!1},perPage:100}).then((e=>{this.loadedSuppliedDetails=e,this.loadedSuppliedDetails.forEach((e=>e.text=e.detailData.name+" "+String(e.cost))),null==this.suppliedDetailId&&this.loadedSuppliedDetails.length>0&&(this.suppliedDetailId=this.loadedSuppliedDetails[0].entityId)})),await this.crud.getSuppliers({sort:{by:"name",desc:!1},perPage:100}).then((e=>{this.suppliers=e,this.suppliers.forEach((e=>e.text=e.name)),null==this.supplierId&&this.suppliers.length>0&&(this.supplierId=this.suppliers[0].entityId)}))},updateSuppliedData(e){this.suppliedDetails=this.loadedSuppliedDetails.filter((t=>t.entityId==e))},submit:function(e,t){this.isValid&&(this.data.suppliedParts=this.suppliedDetailId,this.data.suppliedDetailData=this.suppliedDetail,this.data.amount=Number(this.data.amount),this.submitHandler(this.data,t))}},computed:{suppliedDetails:function(){return this.loadedSuppliedDetails.filter((e=>e.supplier==this.supplierId))},suppliedDetail:function(){return this.suppliedDetails.find((e=>e.entityId==this.suppliedDetailId))},costPerDetail:function(){return null==this.suppliedDetail?0:this.suppliedDetail.cost},costAll:function(){return null==this.suppliedDetail?0:this.suppliedDetail.cost*this.data.amount},amountState:function(){return this.data.amount>0&&!isNaN(this.data.amount)&&null},suppliedDetailState:function(){return null!=this.suppliedDetail&&null},isValid:function(){return null==this.amountState&&null!=this.suppliedDetailId}}},j=F,B=(0,f.Z)(j,Z,z,!1,null,null,null),J=B.exports,L={name:"SuppliesView",components:{TableComponent:k,RemoveModalComponent:O,SupplyModalComponent:J},data(){return{fields:[{key:"date",sortable:!0,label:"Дата",formatter:e=>e.split("T")[0]},{key:"detailData",label:"Деталь",formatter:e=>e.name},{key:"supplierData",label:"Поставщик",formatter:e=>e.name},{key:"amount",sortable:!0,filtrable:!0,label:"Количество"},{key:"suppliedDetailData",label:"Цена",formatter:e=>e.cost},{key:"costAll",sortable:!1,filtrable:!1,label:"Общая цена"},{key:"actions",label:"Действия",stickyColumn:!0}]}},props:{user:{type:Object,required:!0},crud:{type:V,required:!0},messageService:{type:p,required:!0}},methods:{supplyPresenter(e){return e.suppliedDetailData.detailData.name+" "+e.suppliedDetailData.supplierData.name},addTableItemHandler(){this.$refs["CreateItemModal"].show()},removeTableItemHandler(e){this.$refs["RemoveItemModal"].show(e)},editTableItemHandler(e){this.$refs["EditItemModal"].show(e)},removeItem(e,t){t.preventDefault(),this.crud.removeSupply(e.entityId).then((()=>{this.$refs["RemoveItemModal"].close(),this.messageService.showDelete(this.supplyPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},addItem(e,t){t.preventDefault(),this.crud.addSupply(e).then((()=>{this.$refs["CreateItemModal"].close(),this.messageService.showCreate(this.supplyPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},updateItem(e,t){t.preventDefault(),this.crud.updateSupply(e.entityId,e).then((()=>{this.$refs["EditItemModal"].close(),this.messageService.showUpdate(this.supplyPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},async loadAllData(e){let t=await this.crud.getSuppliedDetail(e.suppliedParts);return e.detailData=await this.crud.getSupplier(t.supplier),e.supplierData=await this.crud.getDetail(t.part).then((t=>e.detail=t)),e.costAll=e.amount*t.cost,e},dataProvider(e){return this.crud.getSupplies(e).then((e=>(console.log("asdfsadf",e),e.forEach((e=>{e.supplierData=e.suppliedDetailData.supplierData,e.detailData=e.suppliedDetailData.detailData,e.costAll=e.amount*e.suppliedDetailData.cost})),e))).catch((e=>(this.messageService.showError(e.message),e)))}}},G=L,W=(0,f.Z)(G,S,D,!1,null,"9598d170",null),X=W.exports,Y=function(){var e=this,t=e._self._c;return t("div",[t("TableComponent",{ref:"table",attrs:{fields:e.fields,dataProvider:e.dataProvider},on:{itemAdd:e.addTableItemHandler,itemRemove:e.removeTableItemHandler,itemEdit:e.editTableItemHandler}}),t("div",[t("RemoveModalComponent",{ref:"RemoveItemModal",attrs:{contentPresenter:t=>e.detailPresenter(t),okHandler:e.removeItem}}),t("DetailModalComponent",{ref:"CreateItemModal",attrs:{crud:e.crud,title:"Создание записи o детали",submitHandler:e.addItem}}),t("DetailModalComponent",{ref:"EditItemModal",attrs:{crud:e.crud,title:"Редактирование записи o детали",submitHandler:e.updateItem}})],1)],1)},K=[],Q=function(){var e=this,t=e._self._c;return t("div",[t("CustomModalComponent",{ref:"custom-modal",attrs:{okHandler:e.submit,title:e.title},scopedSlots:e._u([{key:"body",fn:function(){return[t("form",{ref:"form"},[t("b-form-group",{attrs:{label:"Название","label-for":"name-input","invalid-feedback":"Название не может быть пустым",state:e.nameState}},[t("b-form-input",{attrs:{id:"name-input",debounce:"500",state:e.nameState,required:""},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}})],1),t("b-form-group",{attrs:{label:"Артикул","label-for":"code-input","invalid-feedback":"Не может быть пустым",state:e.codeState}},[t("b-form-input",{attrs:{id:"code-input",debounce:"500",state:e.codeState,required:""},model:{value:e.data.partNumber,callback:function(t){e.$set(e.data,"partNumber",t)},expression:"data.partNumber"}})],1),t("b-form-group",{attrs:{label:"Примечание","label-for":"note-input","invalid-feedback":"Ошибка в примечании",state:e.noteState}},[t("b-form-input",{attrs:{id:"note-input",debounce:"500",state:e.noteState,required:""},model:{value:e.data.note,callback:function(t){e.$set(e.data,"note",t)},expression:"data.note"}})],1)],1)]},proxy:!0}])})],1)},ee=[],te={name:"DetailModalComponent",components:{CustomModalComponent:q},data(){return{data:{id:"",entityId:"",name:null,note:null,partNumber:null}}},props:{title:{type:String,default:"Редактирование записи"},submitHandler:{type:Function,default:function(){}},crud:{type:V,required:!0}},methods:{show(e){void 0!==e?(this.data.id=e.id,this.data.entityId=e.entityId,this.data.name=e.name,this.data.partNumber=e.partNumber,this.data.note=e.note):(this.data.id="",this.data.entityId="",this.data.name="",this.data.partNumber="",this.data.note=""),this.$refs["custom-modal"].show(this.data)},close(){this.$refs["custom-modal"].close()},isEmpty(e){return null==e||void 0==e||""!=e.trim()},submit:function(e,t){t.preventDefault(),this.isValid&&this.submitHandler(this.data,t)}},computed:{nameState(){return!!this.isEmpty(this.data.name)&&null},noteState(){return null},codeState(){return!!this.isEmpty(this.data.partNumber)&&null},isValid(){return null==this.nameState&&null==this.noteState&&null==this.codeState}}},ae=te,se=(0,f.Z)(ae,Q,ee,!1,null,null,null),re=se.exports,ie={name:"DetailsView",components:{TableComponent:k,RemoveModalComponent:O,DetailModalComponent:re},data(){return{fields:[{key:"name",sortable:!0,label:"Название",filtrable:!0},{key:"partNumber",sortable:!0,filtrable:!0,label:"Артикул"},{key:"note",sortable:!0,filtrable:!0,label:"Примечание"},{key:"actions",label:"Действия",stickyColumn:!0}]}},props:{user:{type:Object,required:!0},crud:{type:V,required:!0},messageService:{type:p,required:!0}},methods:{detailPresenter(e){return e.name+" "+e.partNumber},addTableItemHandler(){this.$refs["CreateItemModal"].show()},removeTableItemHandler(e){this.$refs["RemoveItemModal"].show(e)},editTableItemHandler(e){this.$refs["EditItemModal"].show(e)},removeItem(e,t){t.preventDefault(),this.crud.removeDetail(e.entityId).then((()=>{this.$refs["RemoveItemModal"].close(),this.messageService.showDelete(this.detailPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},addItem(e,t){t.preventDefault(),this.crud.addDetail(e).then((()=>{this.$refs["CreateItemModal"].close(),this.messageService.showCreate(this.detailPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},updateItem(e,t){t.preventDefault(),this.crud.updateDetail(e.entityId,e).then((()=>{this.$refs["EditItemModal"].close(),this.messageService.showUpdate(this.detailPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},dataProvider(e){return this.crud.getDetails(e).catch((e=>(this.messageService.showError("Не удалось получить данные"),e)))}}},le=ie,ne=(0,f.Z)(le,Y,K,!1,null,"e1b5ac06",null),oe=ne.exports,de=function(){var e=this,t=e._self._c;return t("div",[t("TableComponent",{ref:"table",attrs:{fields:e.fields,dataProvider:e.dataProvider},on:{itemAdd:e.addTableItemHandler,itemRemove:e.removeTableItemHandler,itemEdit:e.editTableItemHandler}}),t("div",[t("RemoveModalComponent",{ref:"RemoveItemModal",attrs:{contentPresenter:t=>e.supplierPresenter(t),okHandler:e.removeItem}}),t("SupplierModalComponent",{ref:"CreateItemModal",attrs:{title:"Создание записи о поставщике",submitHandler:e.addItem}}),t("SupplierModalComponent",{ref:"EditItemModal",attrs:{title:"Редактирование записи о поставщике",submitHandler:e.updateItem}})],1)],1)},ue=[],pe=function(){var e=this,t=e._self._c;return t("div",[t("CustomModalComponent",{ref:"custom-modal",attrs:{okHandler:e.submit,title:e.title},scopedSlots:e._u([{key:"body",fn:function(){return[t("form",{ref:"form"},[t("b-form-group",{attrs:{label:"Название","label-for":"name-input","invalid-feedback":"Не может быть пустым",state:e.nameState}},[t("b-form-input",{attrs:{id:"name-input",state:e.nameState,placeholder:"Введите название",debounce:"500",required:""},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}})],1),t("b-form-group",{attrs:{label:"Адрес","label-for":"name-input","invalid-feedback":"Не может быть пустым",state:e.addressState}},[t("b-form-input",{attrs:{id:"name-input",state:e.addressState,placeholder:"Введите адрес",debounce:"500",required:""},model:{value:e.data.address,callback:function(t){e.$set(e.data,"address",t)},expression:"data.address"}})],1),t("b-form-group",{attrs:{label:"Телефон","label-for":"name-input","invalid-feedback":"Неверный формат. Пример: 89999999999",state:e.phoneState}},[t("b-form-input",{attrs:{id:"name-input",type:"tel",state:e.phoneState,placeholder:"Введите телефон",debounce:"500",required:""},model:{value:e.data.phone,callback:function(t){e.$set(e.data,"phone",t)},expression:"data.phone"}})],1)],1)]},proxy:!0}])})],1)},me=[],ce={name:"SupplierModalComponent",components:{CustomModalComponent:q},data(){return{data:{id:"",entityId:"",name:"",address:"",phone:""}}},props:{title:{type:String,default:"Редактирование записи"},submitHandler:{type:Function,default:function(){}}},methods:{show(e){void 0!==e?(this.data.id=e.id,this.data.entityId=e.entityId,this.data.name=e.name,this.data.address=e.address,this.data.phone=e.phone):(this.data.id="",this.data.entityId="",this.data.name="",this.data.address="",this.data.phone=""),this.$refs["custom-modal"].show(this.data)},close(){this.$refs["custom-modal"].close()},submit(e,t){t.preventDefault(),this.isValid&&this.submitHandler(this.data,t)},validateName(e){return null!=e&&""!=e&&null},validateTelephone(e){console.log(e);let t=/^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\- ]?)?[\d\- ]{7,10}$/gm,a=t.exec(e);return null!=a&&a[0]==e&&null}},computed:{addressState(){return this.validateName(this.data.address)},nameState(){return this.validateName(this.data.name)},phoneState(){return this.validateTelephone(this.data.phone)},isValid(){return null==this.addressState&&null==this.nameState&&null==this.phoneState}}},he=ce,fe=(0,f.Z)(he,pe,me,!1,null,null,null),be=fe.exports,ve={name:"SuppliersView",components:{TableComponent:k,RemoveModalComponent:O,SupplierModalComponent:be},data(){return{fields:[{key:"name",sortable:!0,filtrable:!0,label:"Название"},{key:"address",sortable:!0,filtrable:!0,label:"Адрес"},{key:"phone",sortable:!0,filtrable:!0,label:"Телефон"},{key:"actions",label:"Действия",stickyColumn:!0}]}},props:{user:{type:Object,required:!0},crud:{type:V,required:!0},messageService:{type:p,required:!0}},methods:{supplierPresenter(e){return e.name},addTableItemHandler(){this.$refs["CreateItemModal"].show()},removeTableItemHandler(e){this.$refs["RemoveItemModal"].show(e)},editTableItemHandler(e){this.$refs["EditItemModal"].show(e)},removeItem(e,t){t.preventDefault(),this.crud.removeSupplier(e.entityId).then((()=>{this.$refs["RemoveItemModal"].close(),this.messageService.showDelete(this.supplierPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},addItem(e,t){t.preventDefault(),this.crud.addSupplier(e).then((()=>{this.$refs["CreateItemModal"].close(),this.messageService.showCreate(this.supplierPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},updateItem(e,t){t.preventDefault(),this.crud.updateSupplier(e.entityId,e).then((()=>{this.$refs["EditItemModal"].close(),this.messageService.showUpdate(this.supplierPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},dataProvider(e){return this.crud.getSuppliers(e).catch((e=>(this.messageService.showError("Не удалось получить данные"),e)))}}},ye=ve,ge=(0,f.Z)(ye,de,ue,!1,null,"094366ba",null),Se=ge.exports,De=function(){var e=this,t=e._self._c;return t("div",[t("TableComponent",{ref:"table",attrs:{fields:e.fields,dataProvider:e.dataProvider},on:{itemAdd:e.addTableItemHandler,itemRemove:e.removeTableItemHandler,itemEdit:e.editTableItemHandler}}),t("div",[t("RemoveModalComponent",{ref:"RemoveItemModal",attrs:{contentPresenter:t=>e.userPresenter(t),okHandler:e.removeItem}}),t("UserModalComponent",{ref:"CreateItemModal",attrs:{title:"Создание записи об пользователе",submitHandler:e.addItem,crud:e.crud}}),t("UserModalComponent",{ref:"EditItemModal",attrs:{title:"Редактирование записи об пользователе",submitHandler:e.updateItem,crud:e.crud}})],1)],1)},Ie=[],we=function(){var e=this,t=e._self._c;return t("div",[t("CustomModalComponent",{ref:"custom-modal",attrs:{okHandler:e.submit,title:e.title},scopedSlots:e._u([{key:"body",fn:function(){return[t("form",{ref:"form"},[t("b-form-group",{attrs:{label:"Логин","label-for":"username-input","invalid-feedback":"Неверный формат логина",state:e.loginState}},[t("b-form-input",{attrs:{id:"username-input",state:e.loginState,update:e.badUsernameMessage=null,placeholder:"Введите логин",debounce:"500",required:""},model:{value:e.data.login,callback:function(t){e.$set(e.data,"login",t)},expression:"data.login"}})],1),t("b-form-group",{attrs:{label:"Пароль","label-for":"password-input","invalid-feedback":"Пароль должен содержать больше 8",state:e.passwordState}},[t("b-form-input",{attrs:{id:"password-input",update:e.badPasswordMessage=null,state:e.passwordState,placeholder:"Введите пароль",debounce:"500",type:"password",required:""},model:{value:e.data.password,callback:function(t){e.$set(e.data,"password",t)},expression:"data.password"}})],1),t("b-form-group",{attrs:{label:"Роль","label-for":"role-radio"}},[t("b-form-radio-group",{attrs:{id:"role-radio"},model:{value:e.selectRole,callback:function(t){e.selectRole=t},expression:"selectRole"}},[t("b-form-radio",{attrs:{value:"user"}},[e._v("Пользователь")]),t("b-form-radio",{attrs:{value:"admin"}},[e._v("Администратор")])],1)],1)],1)]},proxy:!0}])})],1)},Pe=[],Ce={name:"StudentModalComponent",components:{CustomModalComponent:q},data(){return{selectRole:"user",data:{login:"",password:""}}},props:{title:{type:String,default:"Редактирование записи"},submitHandler:{type:Function,default:function(){}},crud:{type:V,required:!0}},methods:{show(e){void 0!==e?(this.data.password="lolkek",this.data.login=e.login):(this.data.password="",this.data.login=""),this.$refs["custom-modal"].show(this.data)},close(){this.$refs["custom-modal"].close()},submit:function(e,t){t.preventDefault(),this.isValid&&(this.data.isAdmin="admin"==this.selectRole,this.submitHandler(this.data,t))},validateName(e){let t=/[a-zA-Z_0-9]+/.exec(e);return null!=t&&1==t.length&&t[0]==e&&null}},computed:{loginState(){return null==this.badUsernameMessage&&this.validateName(this.data.login)},passwordState(){return null==this.badPasswordMessage&&8<this.data.password.length&&this.data.password.length<40&&null},isValid(){return null==this.loginState&&null==this.emailState&&null==this.passwordState}}},Me=Ce,ke=(0,f.Z)(Me,we,Pe,!1,null,null,null),xe=ke.exports,_e={name:"UsersView",components:{TableComponent:k,RemoveModalComponent:O,UserModalComponent:xe},data(){return{fields:[{key:"login",label:"Логин"},{key:"isAdmin",label:"Роли",formatter:e=>e?"Администратор":"Пользователь"},{key:"actions",label:"Действия",stickyColumn:!0,editable:!1}]}},props:{user:{type:Object,required:!0},crud:{type:V,required:!0},messageService:{type:p,required:!0}},methods:{userPresenter(e){return e.login},addTableItemHandler(){this.$refs["CreateItemModal"].show()},removeTableItemHandler(e){this.$refs["RemoveItemModal"].show(e)},editTableItemHandler(e){this.$refs["EditItemModal"].show(e)},removeItem(e,t){t.preventDefault(),this.crud.removeUser(e.id).then((()=>{this.$refs["RemoveItemModal"].close(),this.messageService.showDelete(this.userPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},addItem(e,t){t.preventDefault(),this.crud.addUser(e).then((()=>{this.$refs["CreateItemModal"].close(),this.messageService.showCreate(this.userPresenter(e)),this.$refs["table"].update()})).catch((e=>{"Error: Username is already taken!"==e.response.message&&this.messageService.showError("Пользователь с таким именем уже существует"),"Password is too easy"==e.response.data&&this.messageService.showError("Пароль слишком легкий, добавьте цифр и спецсимволов"),"Error: Email is already in use!"==e.response.message&&this.messageService.showError("Пользователь с такой почтой уже существует")}))},updateItem(e,t){t.preventDefault(),this.crud.updateUser(e.entityId,e).then((()=>{this.$refs["EditItemModal"].close(),this.messageService.showUpdate(this.userPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},dataProvider(e){return this.crud.getUsers(e).catch((e=>(this.messageService.showError("Не удалось получить данные"),e)))}}},He=_e,Te=(0,f.Z)(He,De,Ie,!1,null,"87290424",null),Ee=Te.exports,$e=function(){var e=this,t=e._self._c;return t("div",[t("TableComponent",{ref:"table",attrs:{fields:e.fields,dataProvider:e.dataProvider},on:{itemAdd:e.addTableItemHandler,itemRemove:e.removeTableItemHandler,itemEdit:e.editTableItemHandler}}),t("div",[t("RemoveModalComponent",{ref:"RemoveItemModal",attrs:{contentPresenter:t=>e.suppliedDetailPresenter(t),okHandler:e.removeItem}}),t("SuppliedDetailModalComponent",{ref:"CreateItemModal",attrs:{title:"Создание записи o цене детали",submitHandler:e.addItem,crud:e.crud}}),t("SuppliedDetailModalComponent",{ref:"EditItemModal",attrs:{title:"Редактирование записи o цене детали",submitHandler:e.updateItem,crud:e.crud}})],1)],1)},Re=[],qe=function(){var e=this,t=e._self._c;return t("div",[t("CustomModalComponent",{ref:"custom-modal",attrs:{okHandler:e.submit,title:e.title},scopedSlots:e._u([{key:"body",fn:function(){return[t("form",{ref:"form"},[t("b-form-group",{attrs:{label:"Цена","label-for":"name-input","invalid-feedback":"Цена должна быть больше 0",state:e.costState}},[t("b-form-input",{attrs:{id:"name-input",state:e.costState,placeholder:"Введите цену",debounce:"500",type:"number",required:""},model:{value:e.data.cost,callback:function(t){e.$set(e.data,"cost",t)},expression:"data.cost"}})],1),t("b-form-group",{attrs:{label:"Дата","label-for":"date-input","invalid-feedback":"Неверный формат даты"}},[t("b-form-input",{attrs:{id:"date-input",debounce:"500",type:"date",required:""},model:{value:e.data.date,callback:function(t){e.$set(e.data,"date",t)},expression:"data.date"}})],1),t("b-form-group",{attrs:{label:"Деталь","label-for":"detail-input"}},[t("b-form-select",{attrs:{id:"detail-input",options:e.details,"text-field":"text","value-field":"entityId",required:""},model:{value:e.detailId,callback:function(t){e.detailId=t},expression:"detailId"}})],1),t("b-form-group",{attrs:{label:"Поставщик","label-for":"supplier-input"}},[t("b-form-select",{attrs:{id:"supplier-input",options:e.suppliers,"text-field":"text","value-field":"entityId",required:""},model:{value:e.supplierId,callback:function(t){e.supplierId=t},expression:"supplierId"}})],1)],1)]},proxy:!0}])})],1)},Ae=[],Ne={name:"SuppliedDetailModalComponent",components:{CustomModalComponent:q},data(){return{supplierId:null,detailId:null,suppliers:[],details:[],data:{id:"",date:(new Date).format("yyyy-mm-dd"),cost:0}}},mounted(){},props:{title:{type:String,default:"Редактирование записи"},submitHandler:{type:Function,default:function(){}},crud:{type:V,required:!0}},methods:{show(e){this.updateData(),void 0!==e?(this.data.id=e.id,this.data.entityId=e.entityId,this.data.cost=e.cost,this.data.date=e.date,this.detailId=e.part,this.supplierId=e.supplier):(this.data.id="",this.data.entityId="",this.data.cost=0,this.data.date=(new Date).format("yyyy-mm-dd")),console.log(this.data.date),console.log(this.detailId),this.$refs["custom-modal"].show(this.data)},close(){this.$refs["custom-modal"].close()},updateData(){this.crud.getSuppliers({sort:{by:"name",desc:!1},perPage:100}).then((e=>{this.suppliers=e,this.suppliers.forEach((e=>e.text=e.name+" "+e.address)),null==this.supplierId&&this.suppliers.length>0&&(this.supplierId=this.suppliers[0].entityId),console.log("updateData suppliers",this.suppliers)})),this.crud.getDetails({perPage:100}).then((e=>{this.details=e,this.details.forEach((e=>e.text=e.name+" "+e.partNumber)),null==this.detailId&&this.details.length>0&&(this.detailId=this.details[0].entityId)}))},submit:function(e,t){t.preventDefault(),this.isValid&&(console.log(this.details),this.data.part=this.detailId,this.data.supplier=this.supplierId,this.data.supplierData=this.suppliers.find((e=>e.entityId==this.supplierId)),this.data.detailData=this.details.find((e=>e.entityId==this.detailId)),this.data.cost=Number(this.data.cost),this.submitHandler(this.data,t))}},computed:{costState(){return!isNaN(this.data.cost)&&this.data.cost>0&&null},isValid(){return null==this.costState}}},Ue=Ne,Oe=(0,f.Z)(Ue,qe,Ae,!1,null,null,null),Ze=Oe.exports,ze={name:"SuppliedDetailsView",components:{TableComponent:k,RemoveModalComponent:O,SuppliedDetailModalComponent:Ze},data(){return{fields:[{key:"date",sortable:!0,filtrable:!1,label:"Дата изменения",formatter:e=>e.split("T")[0]},{key:"cost",sortable:!0,filtrable:!1,label:"Цена"},{key:"detailData",label:"Название детали",formatter:e=>e.name},{key:"detailData",label:"Артикул",formatter:e=>e.partNumber},{key:"supplierData",label:"Поставщик",formatter:e=>e.name},{key:"actions",label:"Действия",stickyColumn:!0}],address:this.connection+"/students"}},props:{user:{type:Object,required:!0},crud:{type:V,required:!0},messageService:{type:p,required:!0}},methods:{suppliedDetailPresenter(e){return e.supplierData.name+" "+e.detailData.name},addTableItemHandler(){this.$refs["CreateItemModal"].show()},removeTableItemHandler(e){this.$refs["RemoveItemModal"].show(e)},editTableItemHandler(e){this.$refs["EditItemModal"].show(e)},removeItem(e,t){t.preventDefault(),this.crud.removeSuppliedDetail(e.entityId).then((()=>{this.$refs["RemoveItemModal"].close(),this.messageService.showDelete(this.suppliedDetailPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},addItem(e,t){t.preventDefault(),this.crud.addSuppliedDetail(e).then((()=>{this.$refs["CreateItemModal"].close(),this.messageService.showCreate(this.suppliedDetailPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},updateItem(e,t){t.preventDefault(),this.crud.updateSuppliedDetail(e.entityId,e).then((()=>{this.$refs["EditItemModal"].close(),this.messageService.showUpdate(this.suppliedDetailPresenter(e)),this.$refs["table"].update()})).catch((e=>{this.messageService.showError(e.message)}))},loadAllData(e){return this.crud.getSupplier(e.supplier).then((t=>{e.supplierData=t})),this.crud.getDetail(e.part).then((t=>{e.detailData=t})),e},dataProvider(e){return this.crud.getSuppliedDetails(e).catch((e=>(this.messageService.showError("Не удалось получить данные"),e)))}}},Ve=ze,Fe=(0,f.Z)(Ve,$e,Re,!1,null,"6006a99d",null),je=Fe.exports,Be={name:"HomePage",components:{SuppliesView:X,DetailsView:oe,SuppliersView:Se,UsersView:Ee,SuppliedDetailsView:je},data(){return document.title="SAD Home",{yearsActive:!0,classesActive:!1}},props:{user:{type:Object,required:!0},crud:{type:V,required:!0},messageService:{type:p,required:!0}},methods:{close(){this.$emit("closed")}}},Je=Be,Le=(0,f.Z)(Je,y,g,!1,null,null,null),Ge=Le.exports,We={name:"App",components:{AuthorizationPage:v,HomePage:Ge},data(){return document.title="SAD",{user:null,connection:"http://192.168.43.136:8080",crudService:null,messageService:new p(this.$bvToast)}},methods:{logOut(){this.user.accessToken="",this.user.uasername="",this.user.isAdmin=!1,this.user=null},logIn(e){this.user=e,this.crudService=new V(this.connection,e.accessToken)}}},Xe=We,Ye=(0,f.Z)(Xe,l,n,!1,null,null,null),Ke=Ye.exports;s["default"].config.productionTip=!1;var Qe=a(2245);s["default"].use(Qe),new s["default"]({render:e=>e(Ke)}).$mount("#app")},186:function(){var e=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,a=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,s=/[^-+\dA-Z]/g,r=function(e,t){e=String(e),t=t||2;while(e.length<t)e="0"+e;return e};return function(i,l,n){var o=e;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(i)||/\d/.test(i)||(l=i,i=void 0),i=i?new Date(i):new Date,isNaN(i))throw SyntaxError("invalid date");l=String(o.masks[l]||l||o.masks["default"]),"UTC:"==l.slice(0,4)&&(l=l.slice(4),n=!0);var d=n?"getUTC":"get",u=i[d+"Date"](),p=i[d+"Day"](),m=i[d+"Month"](),c=i[d+"FullYear"](),h=i[d+"Hours"](),f=i[d+"Minutes"](),b=i[d+"Seconds"](),v=i[d+"Milliseconds"](),y=n?0:i.getTimezoneOffset(),g={d:u,dd:r(u),ddd:o.i18n.dayNames[p],dddd:o.i18n.dayNames[p+7],m:m+1,mm:r(m+1),mmm:o.i18n.monthNames[m],mmmm:o.i18n.monthNames[m+12],yy:String(c).slice(2),yyyy:c,h:h%12||12,hh:r(h%12||12),H:h,HH:r(h),M:f,MM:r(f),s:b,ss:r(b),l:r(v,3),L:r(v>99?Math.round(v/10):v),t:h<12?"a":"p",tt:h<12?"am":"pm",T:h<12?"A":"P",TT:h<12?"AM":"PM",Z:n?"UTC":(String(i).match(a)||[""]).pop().replace(s,""),o:(y>0?"-":"+")+r(100*Math.floor(Math.abs(y)/60)+Math.abs(y)%60,4),S:["th","st","nd","rd"][u%10>3?0:(u%100-u%10!=10)*u%10]};return l.replace(t,(function(e){return e in g?g[e]:e.slice(1,e.length-1)}))}}();e.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},e.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(t,a){return e(this,t,a)},String.prototype.format=String.prototype.f=function(){var e=arguments;return this.replace(/\{(\d+)\}/g,(function(t,a){return e[a]?e[a]:t}))}}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,s,r,i){if(!s){var l=1/0;for(u=0;u<e.length;u++){s=e[u][0],r=e[u][1],i=e[u][2];for(var n=!0,o=0;o<s.length;o++)(!1&i||l>=i)&&Object.keys(a.O).every((function(e){return a.O[e](s[o])}))?s.splice(o--,1):(n=!1,i<l&&(l=i));if(n){e.splice(u--,1);var d=r();void 0!==d&&(t=d)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[s,r,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,i,l=s[0],n=s[1],o=s[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(o)var u=o(a)}for(t&&t(s);d<l.length;d++)i=l[d],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(u)},s=self["webpackChunksad"]=self["webpackChunksad"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(8105)}));s=a.O(s)})();
//# sourceMappingURL=app.6c81b541.js.map